<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>storage demo示例</title>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="format-detection" content="email=no"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0"/>
    <link rel="stylesheet" type="text/css" href="https://a.alipayobjects.com/amui/base/1.0.1/amui-https.css"
          media="all">
    <script src="http://libs.baidu.com/zepto/0.8/zepto.min.js"></script>
    //todo 参考combo连接符号
    <script src="AJMod.js?../src/storage.js"></script>
    <style>
        body {
            margin: 15px;
        }

        .unit {
            margin: 15px 0;
        }

    </style>
</head>
<body>
<h3>storage</h3>

<div id="tests"></div>

<script type="text/javascript">
    var testUnits = [
        {
            name: "清除所有缓存",
            command: function () {
                AJ.storage.clear();
            }
        },
        {
            name: "设置缓存 key1，value1",
            command: function () {
                AJ.storage.set("key1", "value1");
            }
        },
        {
            name: "设置过期缓存 绝对时间 key1 对象 当前时间后三秒的date对象",
            command: function () {
                var date = new Date((+new Date()) + 3000);
                AJ.storage.set("key1", {a: "2a", b: true, c: 34, d: [1, 2, "a"]}, date);
            }
        },
        {
            name: "设置过期缓存 相对时间 key2 value1 当起时间后三秒的时间戳",
            command: function () {
                var date = 3;
                AJ.storage.set("key2", "value1", date);
            }
        },
        {
            name: "读取key1缓存",
            command: function () {
                console.log(AJ.storage.get("key1"));
            }
        },
        {
            name: "读取key2缓存",
            command: function () {
                console.log(AJ.storage.get("key2"));
            }
        },
        {
            name: "清除key1缓存,通过remove方法",
            command: function () {
                AJ.storage.remove("key1");
            }
        },
        {
            name: "查询key1的过期日期",
            command: function () {
                console.log(AJ.storage.getExpiredDate("key1"));
            }
        },
        {
            name: "将localstorage加满",
            command: function () {
                var fillBlank = [];
                fillBlank[100000] = 0;
                fillBlank = fillBlank.join();
                for (var i = 0; i < 10; i++) {
                    localStorage[100000000 + Math.random(899999999)*100000000] = fillBlank;
                }
            }
        },
    ];

    function createUnitLayout() {
        var htmlTpl = "";
        testUnits.forEach(function (unit, index) {
            htmlTpl = "<div class='unit'><button onclick='(" + testUnits[index].command + ")();'>" + unit.name + "</button></div>";
            $("#tests").append(htmlTpl);
        });

    }

    createUnitLayout();
</script>
</body>
</html>